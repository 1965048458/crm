<!DOCTYPE html>
<html>
<head>
    <title>工作日志</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <link rel="stylesheet" href="/weui.css">
    <link rel="stylesheet" href="/example.css"/>
    <script src="/lib/jquery-2.1.1.js"></script>
    <script src="/vue.v2.5.13.js"></script>
    <script src="/journal/journalList.js"></script>
    <style>
        .center-box {
            text-align: center;
        }

        .center-ele {
            display: inline-block;
        }

        .top-bar, .journal-box, #journalDetail {
            font-size: 18px;
            text-align: center;
            background: #ffffff;
            border-bottom: solid 1px #DDDDDD;
        }

        .pull-left {
            float: left !important;
        }

        .pull-right {
            float: right !important;
        }

        .journal-box {
            text-align: left;
            font-size: 18px;
            padding: 5px 15px;
        }

        #journalDetail {
            text-align: left;
            padding: 5px 15px;
        }

        .add-journal {
            position: absolute;
            top: 30px;
            right: 20px;
            z-index: 99999;
        }

        .add-journal-item {
            padding: 10px 10px;
            font-size: 15px;
            color: #0D0D0D;
        }
    </style>
</head>
<body>


<div class="page tabbar js_show">
    <div class="weui-tab">
        <div class="weui-tab__panel">
            <div id="journalVue">
                <div id="journalList" v-show="showPage === 'journalList'">

                    <div class="weui-navbar">
                            <span class="center-ele"
                                  style="display:inline-block;font-size: 20px;margin-top: 5px;margin-left: 40%;">工作日志</span>
                        <label style="visibility: hidden">&nbsp;占位来表示空格</label>
                        <span class="center-ele"
                              style="display:inline-block;width:20px;height:40px;font-size: 30px; color: #00FFFF; padding-bottom: 0px;margin-left:0%;"
                              @click="clickAddJournalButton">+</span>
                    </div>

                    <div id="addJournalChosenDialog" style="display: none" v-show="showAddJournalDialog">
                        <div class="weui-mask" @click="cancelAddJournalEvent"></div>
                        <div class="add-journal">
                            <div class="weui-actionsheet__menu" style="border-radius: 0.33em">
                                <a href="/journal/edit?type=DAILY">
                                    <div class="weui-actionsheet__cell add-journal-item">填写日报</div>
                                </a>
                                <a href="/journal/edit?type=WEEKLY">
                                    <div class="weui-actionsheet__cell add-journal-item"
                                         style="border-top: 1px solid #e5e5e5;">填写周报
                                    </div>
                                </a>
                                <a href="/journal/edit?type=MONTHLY">
                                    <div class="weui-actionsheet__cell add-journal-item"
                                         style="border-top: 1px solid #e5e5e5;">填写月报
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>

                    <div class="weui-navbar" style="margin-top: 40px">
                        <div class="weui-navbar__item weui-bar__item_on">
                            <span @click="searchAll">全部</span>
                        </div>
                        <div class="weui-navbar__item">
                            <span @click="searchUnRead">未读<span v-text=""></span></span>
                        </div>
                        <div class="weui-navbar__item">
                            <span @click="searchMine">我的</span>
                        </div>
                        <div class="weui-navbar__item">
                            <span @click="searchDay">日报</span>
                        </div>
                        <div class="weui-navbar__item">
                            <span @click="searchWeek">周报</span>
                        </div>
                        <div class="weui-navbar__item">
                            <span @click="searchMonth">月报</span>
                        </div>
                        <div class="weui-navbar__item" @click="toFilter()">
                            <span >
                                <img style="width: 20px;height: 20px;padding-top: 0px"
                                     src="/images/journal/filter.png"></span>
                        </div>
                    </div>


                    <div class="journal-list">
                        <div class="weui-flex">
                            <div class="weui-flex__item">
                                <div class="placeholder" style="visibility: hidden">weui</div>
                            </div>
                        </div>
                        <div class="weui-flex">
                            <div class="weui-flex__item">
                                <div class="placeholder" style="visibility: hidden">weui</div>
                            </div>
                        </div>
                        <div class="weui-flex">
                            <div class="weui-flex__item">
                                <div class="placeholder" style="visibility: hidden">weui</div>
                            </div>
                        </div>
                        <div class="weui-flex">
                            <div class="weui-flex__item">
                                <div class="placeholder" style="visibility: hidden">weui</div>
                            </div>
                        </div>
                        <div class="journal-box" v-for="journal in journalList">
                            <div class="weui-panel__bd">
                                <a href="javascript:;" class="weui-media-box weui-media-box_appmsg">
                                    <div class="weui-media-box__hd">
                                        <img src="/images/journal/defaultUserIcon.png" style="width: 60px;height: 60px"
                                             alt=""
                                             class="weui-tabbar__icon">
                                    </div>
                                    <div class="weui-media-box__bd">
                                        <h4 class="weui-media-box__title">{{journalName(journal)}}</h4>
                                        <p class="weui-media-box__desc">{{journal.createTs}}</p>

                                    </div>
                                </a>
                            </div>

                            <div class="weui-form-preview" @click="loadDetail(journal)">
                                <div class="weui-form-preview__bd">
                                    <div class="weui-form-preview__item">
                                        <label class="weui-form-preview__label">今日总结:</label>
                                        <span class="weui-form-preview__value" style="text-align:left">{{journal.summary}}</span>
                                    </div>
                                    <div class="weui-form-preview__item">
                                        <label class="weui-form-preview__label">明日计划:</label>
                                        <span class="weui-form-preview__value"
                                              style="text-align:left">{{journal.plan}}</span>
                                    </div>
                                </div>
                            </div>

                            <div class="weui-form-preview" v-for="(visitRecord, ind) in journal.visitRecords">
                                <div class="weui-form-preview__bd">
                                    <div class="weui-form-preview__item" style="font-size: .8em;">
                                        <span class="weui-form-preview__value" style="text-align: left;">
                                            <p v-text="'今日拜访' + (ind+1) + ':'"></p>
                                            <p v-for="contacts in visitRecord.chosenContacts">
                                                <span v-text="contacts.totalName"></span>
                                            </p>
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <div class="weui-form-preview" v-for="patch in journal.journalPatches">
                                <div class="weui-form-preview__bd">
                                    <div class="weui-form-preview__item" style="font-size: .8em;">
                                        <span class="weui-form-preview__value" style="text-align: left;">
                                            <p v-text="patch.createTs + ' ' + '补充'">2018-07-26 13:01:59 补充</p>
                                            <p v-text="patch.content">这是我的补充信息</p>
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <div v-show="journal.isMine">
                                <div  style="display:block" :id="'patchButtonDiv_'+journal.journalId">
                                    <a style="font-size:14px" class="weui-btn weui-btn_default" @click="patchAction(journal.journalId)"> 补充日志信息 </a>
                                </div>
                                <div style="display:none" :id="'patchDiv_'+journal.journalId">
                                    <div class="weui-form-preview">
                                        <div class="weui-form-preview__bd">
                                            <div class="weui-form-preview__item">
                                                <textarea class="weui-textarea" placeholder="补充" rows="3" style="font-size:14px;" :id="'patchContent_'+journal.journalId"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <a style="font-size:14px" class="weui-btn weui-btn_default" @click="patchSubmit(journal.journalId)">提交</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="journalDetail" v-show="showPage === 'journalDetail'">
                    <div class="top-bar">

                        <div class="top-bar" style="height: 40px;">
                            <span @click="backToList" class="pull-left" style="margin-top: 4px;"><img
                                    src="/images/back_icon.svg"
                                    style="margin-top:3px"/></span>
                            <span style="display:block;padding-top:3px" v-text="journalName(curJournal)"></span>
                        </div>
                    </div>
                    <div id="journalContent">
                        <div class="weui-panel__bd">
                            <a href="javascript:;" class="weui-media-box weui-media-box_appmsg">
                                <div class="weui-media-box__hd">
                                    <img src="/images/journal/defaultUserIcon.png" style="width: 60px;height: 60px"
                                         alt=""
                                         class="weui-tabbar__icon">
                                </div>
                                <div class="weui-media-box__bd">
                                    <h4 class="weui-media-box__title">{{curJournal.user.realName}}</h4>
                                    <p class="weui-media-box__desc">{{curJournal.createTs}}</p>

                                </div>
                            </a>
                        </div>

                        <div class="weui-form-preview">
                            <div class="weui-form-preview__bd">
                                <div class="weui-form-preview__item">
                                    <label class="weui-form-preview__label">今日总结:</label>
                                    <span class="weui-form-preview__value" style="text-align:left">{{curJournal.summary}}</span>
                                </div>
                                <div class="weui-form-preview__item">
                                    <label class="weui-form-preview__label">明日计划:</label>
                                    <span class="weui-form-preview__value"
                                          style="text-align:left">{{curJournal.plan}}</span>
                                </div>

                                <div class="weui-form-preview" v-for="(visitRecord, ind) in curJournal.visitRecords">
                                    <div class="weui-form-preview__bd" style="padding: 5px 0px">
                                        <div class="weui-form-preview__item"  style="font-size: .8em;">
                                            <span class="weui-form-preview__value" style="text-align: left;">
                                                <p v-text="'今日拜访' + (ind+1) + ':'"></p>
                                                <p v-for="contacts in visitRecord.chosenContacts">
                                                    <span v-text="contacts.totalName"></span>
                                                </p>
                                                <p v-text="'拜访类型'+':'+' '+convertVisitType(visitRecord.visitType)"></p>
                                                <p v-text="'拜访结果'+':'+' '+visitRecord.visitResult"></p>
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="weui-form-preview" v-for="patch in curJournal.journalPatches">
                                    <div class="weui-form-preview__bd" style="padding: 5px 0px">
                                        <div class="weui-form-preview__item" style="font-size: .8em;">
                                        <span class="weui-form-preview__value" style="text-align: left;">
                                            <p v-text="patch.createTs + ' ' + '补充'">2018-07-26 13:01:59 补充</p>
                                            <p v-text="patch.content">这是我的补充信息</p>
                                        </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <!--<div class="weui-form-preview__ft">-->
                        <!--<a class="weui-form-preview__btn weui-form-preview__btn_default" @click="showRead = true">已读</a>-->
                        <!--<button type="submit" class="weui-form-preview__btn weui-form-preview__btn_primary" @click="showRead = false">未读</button>-->
                        <!--</div>-->
                        <div v-show="showRead" class="weui-cells" style="margin-top: 0">
                            <div class="weui-cell" v-for="user in curJournal.read">
                    <span style="display: inline-block;position: relative;">
                        <img src="/images/journal/defaultUserIcon.png" alt="" class="weui-tabbar__icon">
                        <p class="weui-tabbar__label" v-text="user.realName"></p>
                    </span>
                            </div>
                        </div>
                        <div v-show="!showRead" class="weui-cells" style="margin-top: 0">
                            <div class="weui-cell" v-for="user in curJournal.unread">
                    <span style="display: inline-block;position: relative;">
                        <img src="/images/journal/defaultUserIcon.png" alt="" class="weui-tabbar__icon">
                        <p class="weui-tabbar__label" v-text="user.realName"></p>
                    </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="container" id="journalFilter" style="display: none" v-show="showPage === 'filterDiv'">
                    <div class="page home js_show">
                        <div class="weui-tab">
                            <div class="weui-navbar" style="height: 40px;">


                                <span @click="backToList" class="pull-left"style="margin-left: 5px;margin-top: 5px"><img src="/images/back_icon.svg" style="margin-top:3px"/></span>
                                <span class="center" style="font-size:20px;margin-left: 40%;margin-top: 3px">筛选日志</span>


                            </div>
                            <div class="weui-tab__panel">
                                <div class="page__bd page__bd_spacing">

                                    <ul>
                                        <li class="">
                                            <div class="weui-cells weui-cells-form">
                                                <div>
                                                    <div class="weui-cell__hd">
                                                        <p class="weui-cells__title">按类型筛选</p>
                                                    </div>
                                                    <div class="weui-cells__hd">
                                                        <div class="weui-cells weui-cells_radio">
                                                            <label class="weui-cell weui-check__label" for="day">
                                                                <div class="weui-cell__bd ">
                                                                    <p>日报</p>
                                                                </div>
                                                                <div class="weui-cell__ft">
                                                                    <input type="radio" class="weui-check" value="DAILY"
                                                                           v-model="journalType" id="day">
                                                                    <span class="weui-icon-checked"></span>
                                                                </div>
                                                            </label>
                                                            <label class="weui-cell weui-check__label" for="week">
                                                                <div class="weui-cell__bd ">
                                                                    <p>周报</p>
                                                                </div>
                                                                <div class="weui-cell__ft">
                                                                    <input type="radio" class="weui-check"
                                                                           value="WEEKLY"
                                                                           v-model="journalType" id="week">
                                                                    <span class="weui-icon-checked"></span>
                                                                </div>
                                                            </label>
                                                            <label class="weui-cell weui-check__label" for="month">
                                                                <div class="weui-cell__bd ">
                                                                    <p>月报</p>
                                                                </div>
                                                                <div class="weui-cell__ft">
                                                                    <input type="radio" class="weui-check"
                                                                           value="MONTHLY"
                                                                           v-model="journalType" id="month">
                                                                    <span class="weui-icon-checked"></span>
                                                                </div>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="">
                                            <div class="weui-cells weui-cells-form">
                                                <div class="weui-cell__hd">
                                                    <p class="weui-cells__title">按员工筛选</p>
                                                </div>
                                                <div class="weui-cell__bd weui-cells-form">
                                                    <div>
                                                        <span>&nbsp; &nbsp;</span>
                                                        <span style="display: inline-block;position: relative;">
                                    <img src="/images/icon_tabbar.png" alt="" class="weui-tabbar__icon">
                                    <p class="weui-tabbar__label">刘勇</p>
                                </span>
                                                        <span style="display: inline-block;position: relative;">
                                    <img src="/images/icon_tabbar.png" alt="" class="weui-tabbar__icon">
                                    <p class="weui-tabbar__label">添加</p>
                                </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="">
                                            <div class="weui-cell weui-cell_select">
                                                <div class="weui-cell__hd">
                                                    <label for class="weui-label">按拜访客户</label>
                                                </div>
                                                <div class="weui-cell__bd">
                                                    <select class="weui-select" id="selectClient" v-model="client">
                                                        <option value="client_1">客户端1</option>
                                                        <option value="client_2">客户端2</option>
                                                        <option value="client_3">客户端3</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="">
                                            <div class="weui-cell weui-cell_select">
                                                <div class="weui-cell__hd">
                                                    <label for class="weui-label">按相关项目</label>
                                                </div>
                                                <div class="weui-cell__bd">
                                                    <select class="weui-select" id="selectProject" v-model="project">
                                                        <option value="project_1">项目1</option>
                                                        <option value="project_2">项目2</option>
                                                        <option value="project_3">项目3</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="">
                                            <div class="weui-cells weui-cells_form">
                                                <a class="weui-cell weui-cell_access js_item" data-id="startTime"
                                                   href="javascript:;">
                                                    <div class="weui-cell__hd">
                                                        <p>开始时间&nbsp; &nbsp; &nbsp;</p>
                                                    </div>
                                                    <div class="weui-cell__bd">
                                                        <input class="weui-input" type="date" v-model="startTime"/>
                                                    </div>
                                                </a>
                                                <a class="weui-cell weui-cell_access js_item" data-id="endTime"
                                                   href="javascript:;">
                                                    <div class="weui-cell__hd">
                                                        <p>结束时间&nbsp; &nbsp; &nbsp;</p>
                                                    </div>
                                                    <div class="weui-cell__bd">
                                                        <input class="weui-input" type="date" v-model="endTime"/>
                                                    </div>
                                                </a>
                                            </div>
                                        </li>
                                        <li class="">
                                            <div class="weui-cell weui-cell_switch">
                                                <div class="weui-cell__bd">未读</div>
                                                <div class="weui-cell__ft">
                                                    <label for="switchCP" class="weui-switch-cp">
                                                        <input id="switchCP" v-model="isRead"
                                                               class="weui-switch-cp__input"
                                                               type="checkbox" checked="checked"/>
                                                        <div class="weui-switch-cp__box"></div>
                                                    </label>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="">
                                            <div class="weui-flex">
                                                <div class="weui-flex__item">
                                                    <div class="placeholder" style="visibility: hidden">weui</div>
                                                </div>
                                                <div class="weui-flex__item">
                                                    <div class="placeholder">
                                                        <button class="weui-btn weui-btn_mini weui-btn_default"
                                                                type=button
                                                                @click="backToList()">
                                                            取消
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="weui-flex__item">
                                                    <div class="placeholder">
                                                        <button class="weui-btn weui-btn_mini weui-btn_primary"
                                                                type=button
                                                                @click="searchFilter()">
                                                            确认
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="weui-flex__item">
                                                    <div class="placeholder" style="visibility: hidden">weui</div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="js_dialog" id="iosDialog2" style="opacity: 1;display: none" v-show="showErrMsg">
                    <div class="weui-mask"></div>
                    <div class="weui-dialog">
                        <div class="weui-dialog__bd" v-text="errMsg"></div>
                        <div class="weui-dialog__ft">
                            <a @click="showErrMsg=false" class="weui-dialog__btn weui-dialog__btn_primary">知道了</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="weui-tabbar">
            <a href="javascript:customer();" class="weui-tabbar__item ">
                <img src="/images/customer.png" alt="" class="weui-tabbar__icon">
                <p class="weui-tabbar__label">客户</p>
            </a>
            <a href="javascript:opportunity();" class="weui-tabbar__item">
                <img src="/images/saleOpportunity.png" alt="" class="weui-tabbar__icon">
                <p class="weui-tabbar__label">销售机会</p>
            </a>
            <a href="javascript:;" class="weui-tabbar__item weui-bar__item_on">
                <img src="/images/journal.png" alt="" class="weui-tabbar__icon">
                <p class="weui-tabbar__label">日志</p>
            </a>
            <a href="javascript:;" class="weui-tabbar__item">
                <img src="/images/cluesPool.png" alt="" class="weui-tabbar__icon">
                <p class="weui-tabbar__label">线索池</p>
            </a>
            <a href="javascript:;" class="weui-tabbar__item">
                <img src="/images/others.png" alt="" class="weui-tabbar__icon">
                <p class="weui-tabbar__label">其他</p>
            </a>
        </div>
    </div>
</div>
<script type="text/javascript" class="tabbar js_show">
    $(function () {
        $('.weui-tabbar__item').on('click', function () {
            $(this).addClass('weui-bar__item_on').siblings('.weui-bar__item_on').removeClass('weui-bar__item_on');
        });
    });
    $(function () {
        $('.weui-navbar__item').on('click', function () {
            $(this).addClass('weui-bar__item_on').siblings('.weui-bar__item_on').removeClass('weui-bar__item_on');
        });
    });
</script>
<script>
    function customer() {
        location.href = '/customer/customerList';
    }
    ;
    function opportunity() {
        location.href = '/opportunity';
    }
</script>
</body>
</html>