<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.xuebei.crm.opportunity.OpportunityMapper">

    <resultMap id="companyMap" type="com.xuebei.crm.company.Company">
        <id property="companyId" column="company_id"/>
        <result property="companyName" column="com_nm"/>
    </resultMap>

    <insert id="addSale" parameterType="com.xuebei.crm.opportunity.Opportunity"
            useGeneratedKeys="true" keyColumn="sales_opportunity_id" keyProperty="opportunityId">
        INSERT INTO `crmdb`.`sales_opportunity` (
            `customer_id`, `opportunity_nm`,
            `sales_status`, `amount`, `check_date`, `clinch_date`,
             `content`, `user_id`
        ) VALUES (
            #{customerId},
            #{opportunityName},
            #{salesStatus},
            #{amount},
            #{checkDate},
            #{clinchDate},
            #{content},
            #{userId}
        )
    </insert>

    <insert id="addOpportunityContact">
        INSERT INTO `crmdb`.`opportunity_contacts` (
            `sales_opportunity_id`, `contacts_id`
        ) VALUES (
            #{opportunityId},
            #{contactId}
        )
    </insert>

</mapper>